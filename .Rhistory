pdf(file="CropProductionFig_A.pdf", pointsize=10, width=4.33, height=3)
plot(dom.c, col=c('sienna3','plum','gold2'),legend=F, xaxt='n', yaxt='n', xlim=c(-20,45),ylim=c(-5,30))
legend(-5,-15, legend=c("1","2","3","4","5","6"), pch=c(17,2,3,16,5,6), box.col=NA, cex=0.5, title="Group")
legend(-18,-15, legend=c("sorghum","millet","maize"), fill=c('sienna3','plum','gold2'), box.col=NA, cex=0.5, title ="Main crop")
map(database="world", xlim=c(-20,50),ylim=c(-10,25),add=T, col="grey40", lwd=0.5, mar=NA)
points(meta2$lon,meta2$lat, pch=meta2$clus, cex=0.7)
scalebar(1000, xy = c(-5,-10), label=" 1000 km",type = "line", divs = 1, lwd = 2,  adj=c(0.5, -0.5), lonlat = TRUE, cex=0.6)
dev.off()
plot(dom.c, col=c('sienna3','plum','gold2'),legend=F, xaxt='n', yaxt='n', xlim=c(-20,45),ylim=c(-5,30))
dom.c <- crop(dom, extent(-20,45,-20,20))
pdf(file="CropProductionFig_A.pdf", pointsize=10, width=4.33, height=3)
plot(dom.c, col=c('sienna3','plum','gold2'),legend=F, xaxt='n', yaxt='n', xlim=c(-20,45),ylim=c(-20,20))
legend(-5,-15, legend=c("1","2","3","4","5","6"), pch=c(17,2,3,16,5,6), box.col=NA, cex=0.5, title="Group")
legend(-18,-15, legend=c("sorghum","millet","maize"), fill=c('sienna3','plum','gold2'), box.col=NA, cex=0.5, title ="Main crop")
map(database="world", xlim=c(-20,50),ylim=c(-10,20),add=T, col="grey40", lwd=0.5, mar=NA)
points(meta2$lon,meta2$lat, pch=meta2$clus, cex=0.7)
scalebar(1000, xy = c(-5,-10), label=" 1000 km",type = "line", divs = 1, lwd = 2,  adj=c(0.5, -0.5), lonlat = TRUE, cex=0.6)
dev.off()
plot(dom.c, col=c('sienna3','plum','gold2'),legend=F, xaxt='n', yaxt='n', xlim=c(-20,45),ylim=c(-10,20))
plot(dom.c, col=c('sienna3','plum','gold2'),legend=F, xaxt='n', yaxt='n', xlim=c(-20,45),ylim=c(-15,20))
plot(dom.c, col=c('sienna3','plum','gold2'),legend=F, xaxt='n', yaxt='n', xlim=c(-20,45),ylim=c(-15,10))
plot(dom.c, col=c('sienna3','plum','gold2'),legend=F, xaxt='n', yaxt='n', xlim=c(-20,45),ylim=c(-12,20))
plot(dom.c, col=c('sienna3','plum','gold2'),legend=F, xaxt='n', yaxt='n', xlim=c(-20,45),ylim=c(-20,20))
plot(dom.c, col=c('sienna3','plum','gold2'),legend=F, xaxt='n', yaxt='n', xlim=c(-20,45),ylim=c(-10,20))
plot(dom.c, col=c('sienna3','plum','gold2'),legend=F, xaxt='n', yaxt='n', xlim=c(-20,45),ylim=c(-5,20))
pdf(file="CropProductionFig_A.pdf", pointsize=10, width=4.33, height=3)
plot(dom.c, col=c('sienna3','plum','gold2'),legend=F, xaxt='n', yaxt='n', xlim=c(-20,45),ylim=c(-5,20))
legend(-5,-15, legend=c("1","2","3","4","5","6"), pch=c(17,2,3,16,5,6), box.col=NA, cex=0.5, title="Group")
legend(-18,-15, legend=c("sorghum","millet","maize"), fill=c('sienna3','plum','gold2'), box.col=NA, cex=0.5, title ="Main crop")
map(database="world", xlim=c(-20,50),ylim=c(-10,20),add=T, col="grey40", lwd=0.5, mar=NA)
points(meta2$lon,meta2$lat, pch=meta2$clus, cex=0.7)
scalebar(1000, xy = c(-5,-10), label=" 1000 km",type = "line", divs = 1, lwd = 2,  adj=c(0.5, -0.5), lonlat = TRUE, cex=0.6)
dev.off()
plot(dom.c, col=c('sienna3','plum','gold2'),legend=F, xaxt='n', yaxt='n', xlim=c(-20,45),ylim=c(-20,20))
legend(-5,-15, legend=c("1","2","3","4","5","6"), pch=c(17,2,3,16,5,6), box.col=NA, cex=0.5, title="Group")
legend(-18,-15, legend=c("sorghum","millet","maize"), fill=c('sienna3','plum','gold2'), box.col=NA, cex=0.5, title ="Main crop")
map(database="world", xlim=c(-20,50),ylim=c(-10,20),add=T, col="grey40", lwd=0.5, mar=NA)
map(database="world", xlim=c(-20,50),ylim=c(-20,20),add=T, col="grey40", lwd=0.5, mar=NA)
plot(dom, col=c('sienna3','plum','gold2'),legend=F, xaxt='n', yaxt='n', xlim=c(-20,45),ylim=c(-20,20))
map(database="world", xlim=c(-20,50),ylim=c(-20,20),add=T, col="grey40", lwd=0.5, mar=NA)
map(database="world", xlim=c(-20,50),ylim=c(-30,20),add=T, col="grey40", lwd=0.5, mar=NA)
map(database="world", xlim=c(-20,50),ylim=c(-30,25),add=T, col="grey40", lwd=0.5, mar=NA)
plot(dom, col=c('sienna3','plum','gold2'),legend=F, xaxt='n', yaxt='n', xlim=c(-20,50),ylim=c(-20,20))
map(database="world", xlim=c(-20,50),ylim=c(-30,25),add=T, col="grey40", lwd=0.5, mar=NA)
map(database="world", xlim=c(-20,60),ylim=c(-30,25),add=T, col="grey40", lwd=0.5, mar=NA)
plot(dom, col=c('sienna3','plum','gold2'),legend=F, xaxt='n', yaxt='n', xlim=c(-20,60),ylim=c(-20,20))
map(database="world", xlim=c(-20,60),ylim=c(-30,25),add=T, col="grey40", lwd=0.5, mar=NA)
map(database="world", xlim=c(-20,50),ylim=c(-30,25),add=T, col="grey40", lwd=0.5, mar=NA)
map(database="world", xlim=c(-20,50),ylim=c(-30,30),add=T, col="grey40", lwd=0.5, mar=NA)
plot(dom, col=c('sienna3','plum','gold2'),legend=F, xaxt='n', yaxt='n', xlim=c(-20,50),ylim=c(-20,40))
map(database="world", xlim=c(-20,50),ylim=c(-30,30),add=T, col="grey40", lwd=0.5, mar=NA)
plot(dom, col=c('sienna3','plum','gold2'),legend=F, xaxt='n', yaxt='n', xlim=c(-20,50),ylim=c(-20,40))
plot(dom, col=c('sienna3','plum','gold2'),legend=F, xaxt='n', yaxt='n', xlim=c(-20,50),ylim=c(-25,40))
map(database="world", xlim=c(-20,50),ylim=c(-25,40),add=T, col="grey40", lwd=0.5, mar=NA)
plot(dom, col=c('sienna3','plum','gold2'),legend=F, xaxt='n', yaxt='n', xlim=c(-20,50),ylim=c(-30,40))
map(database="world", xlim=c(-20,50),ylim=c(-30,40),add=T, col="grey40", lwd=0.5, mar=NA)
plot(dom, col=c('sienna3','plum','gold2'),legend=F, xaxt='n', yaxt='n', xlim=c(-20,50),ylim=c(-35,40))
map(database="world", xlim=c(-20,50),ylim=c(-35,40),add=T, col="grey40", lwd=0.5, mar=NA)
pdf(file="CropProductionFig_B.pdf", pointsize=10, width=4.33, height=3)
plot(dom, col=c('sienna3','plum','gold2'),legend=F, xaxt='n', yaxt='n', xlim=c(-20,50),ylim=c(-35,40))
#legend(-5,-15, legend=c("1","2","3","4","5","6"), pch=c(17,2,3,16,5,6), box.col=NA, cex=0.5, title="Group")
#legend(-18,-15, legend=c("sorghum","millet","maize"), fill=c('sienna3','plum','gold2'), box.col=NA, cex=0.5, title ="Main crop")
map(database="world", xlim=c(-20,50),ylim=c(-35,40),add=T, col="grey40", lwd=0.5, mar=NA)
scalebar(1000, xy = c(-5,-10), label=" 1000 km",type = "line", divs = 1, lwd = 2,  adj=c(0.5, -0.5), lonlat = TRUE, cex=0.6)
dev.off()
scalebar(1000, xy = c(30,-30), label=" 1000 km",type = "line", divs = 1, lwd = 2,  adj=c(0.5, -0.5), lonlat = TRUE, cex=0.6)
scalebar(1000, xy = c(35,-30), label=" 1000 km",type = "line", divs = 1, lwd = 2,  adj=c(0.5, -0.5), lonlat = TRUE, cex=0.6)
pdf(file="CropProductionFig_B.pdf", pointsize=10, width=4.33, height=3)
plot(dom, col=c('sienna3','plum','gold2'),legend=F, xaxt='n', yaxt='n', xlim=c(-20,50),ylim=c(-35,40))
#legend(-5,-15, legend=c("1","2","3","4","5","6"), pch=c(17,2,3,16,5,6), box.col=NA, cex=0.5, title="Group")
#legend(-18,-15, legend=c("sorghum","millet","maize"), fill=c('sienna3','plum','gold2'), box.col=NA, cex=0.5, title ="Main crop")
map(database="world", xlim=c(-20,50),ylim=c(-35,40),add=T, col="grey40", lwd=0.5, mar=NA)
scalebar(1000, xy = c(35,-30), label=" 1000 km",type = "line", divs = 1, lwd = 2,  adj=c(0.5, -0.5), lonlat = TRUE, cex=0.6)
dev.off()
pdf(file="CropProductionFig_B.pdf", pointsize=10, width=4.33, height=3)
plot(dom, col=c('sienna3','plum','gold2'),legend=F, xaxt='n', yaxt='n', xlim=c(-20,50),ylim=c(-35,40))
#legend(-5,-15, legend=c("1","2","3","4","5","6"), pch=c(17,2,3,16,5,6), box.col=NA, cex=0.5, title="Group")
#legend(-18,-15, legend=c("sorghum","millet","maize"), fill=c('sienna3','plum','gold2'), box.col=NA, cex=0.5, title ="Main crop")
map(database="world", xlim=c(-20,50),ylim=c(-35,40),add=T, col="grey40", lwd=0.5, mar=NA)
scalebar(1000, xy = c(35,-32), label=" 1000 km",type = "line", divs = 1, lwd = 2,  adj=c(0.5, -0.5), lonlat = TRUE, cex=0.6)
dev.off()
pdf(file="CropProductionFig_B.pdf", pointsize=10, width=4.33, height=3)
plot(dom, col=c('sienna3','plum','gold2'),legend=F, xaxt='n', yaxt='n', xlim=c(-20,50),ylim=c(-40,45))
#legend(-5,-15, legend=c("1","2","3","4","5","6"), pch=c(17,2,3,16,5,6), box.col=NA, cex=0.5, title="Group")
#legend(-18,-15, legend=c("sorghum","millet","maize"), fill=c('sienna3','plum','gold2'), box.col=NA, cex=0.5, title ="Main crop")
map(database="world", xlim=c(-20,50),ylim=c(-40,45),add=T, col="grey40", lwd=0.5, mar=NA)
scalebar(1000, xy = c(35,-32), label=" 1000 km",type = "line", divs = 1, lwd = 2,  adj=c(0.5, -0.5), lonlat = TRUE, cex=0.6)
dev.off()
pdf(file="CropProductionFig_B.pdf", pointsize=10, width=4.33, height=3)
plot(dom, col=c('sienna3','plum','gold2'),legend=F, xaxt='n', yaxt='n', xlim=c(-20,50),ylim=c(-40,45))
legend(-5,-15, legend=c("1","2","3","4","5","6"), pch=c(17,2,3,16,5,6), box.col=NA, cex=0.5, title="Group")
#legend(-18,-15, legend=c("sorghum","millet","maize"), fill=c('sienna3','plum','gold2'), box.col=NA, cex=0.5, title ="Main crop")
map(database="world", xlim=c(-20,50),ylim=c(-40,45),add=T, col="grey40", lwd=0.5, mar=NA)
scalebar(1000, xy = c(35,-32), label=" 1000 km",type = "line", divs = 1, lwd = 2,  adj=c(0.5, -0.5), lonlat = TRUE, cex=0.6)
dev.off()
pdf(file="CropProductionFig_B.pdf", pointsize=10, width=4.33, height=3)
plot(dom, col=c('sienna3','plum','gold2'),legend=F, xaxt='n', yaxt='n', xlim=c(-20,50),ylim=c(-40,45))
legend(-5,-5, legend=c("1","2","3","4","5","6"), pch=c(17,2,3,16,5,6), box.col=NA, cex=0.5, title="Group")
#legend(-18,-15, legend=c("sorghum","millet","maize"), fill=c('sienna3','plum','gold2'), box.col=NA, cex=0.5, title ="Main crop")
map(database="world", xlim=c(-20,50),ylim=c(-40,45),add=T, col="grey40", lwd=0.5, mar=NA)
scalebar(1000, xy = c(35,-32), label=" 1000 km",type = "line", divs = 1, lwd = 2,  adj=c(0.5, -0.5), lonlat = TRUE, cex=0.6)
dev.off()
library(ggdendro)
library(dplyr)
library(ggplot2)
library(tidyr)
library(cowplot)
################  load gps points for experimental studies
meta <- read.csv('SI.dat.1.30.20.csv')
setwd('~/Downloads/')
################  load gps points for experimental studies
meta <- read.csv('SI.dat.1.30.20.csv')
setwd('/Users/emilywork/Documents/GitHub/StrigaMacroecologyMS')
################  load gps points for experimental studies
meta <- read.csv('SI.dat.1.30.20.csv')
meta <- subset(meta, emergence != "NA") # 27 localities
############## fig for relative emergence.
tmp <- meta %>% select(locality, emergence, host) %>% group_by(locality, host) %>% summarize(emg = mean(emergence))
tmp2 <- tmp %>% group_by(locality) %>% summarize(total=sum(emg))
tmp3 <- inner_join(tmp, tmp2)
tmp3$locality <- factor(tmp3$locality, levels = c("Bambey", "Maradi", "Mintimbougou","FarakoBa","SinthionMaleme","Samaru","AbuNaama","Kamboinse","Kobo","Yendi","Tamale","WadMedani","Galadima","Bakura","Damaturu","Jibiya","Andre","Kankia","Bida","Gombe","Gumi","Busia","Gwoza","Mokwa","Ngezima","Kazgail","Obeid"))
p <- ggplot(tmp3, aes(x=locality, y=emg, col=host, fill=host)) + geom_bar(position="stack", stat="identity", alpha=0.4) +theme_minimal()+ scale_colour_manual(values=c('gold2','plum','sienna3'), labels=c("maize", "pearl millet","sorghum"), name="Host") + scale_fill_manual(values=c('gold2','plum','sienna3'), labels=c("maize", "pearl millet","sorghum"), name="Host")+ theme(axis.text.x=element_text(angle=90, vjust=0.4, hjust=1), legend.position="top",panel.grid.major = element_blank(),panel.grid.minor = element_blank()) + ylab("Relative emergence") + xlab("")
p <- p + geom_vline(xintercept=2.5, lwd=0.3, lty=2) + geom_vline(xintercept=5.5, lwd=0.3, lty=2) + geom_vline(xintercept=12.5, lwd=0.3, lty=2) +  geom_vline(xintercept=15.5, lwd=0.3, lty=2) + annotate('text', x=26, y = 1.7, label="*", size=7)+ annotate('text', x=27, y = 1.7, label="*", size=7)
p
p <- p + geom_vline(xintercept=2.5, lwd=0.3, lty=2) + geom_vline(xintercept=5.5, lwd=0.3, lty=2) + geom_vline(xintercept=12.5, lwd=0.3, lty=2) +  geom_vline(xintercept=15.5, lwd=0.3, lty=2) + annotate('text', x=26, y = 1.7, label="*", size=7)+ annotate('text', x=27, y = 1.7, label="*", size=7) + annotate('text', x=1.5, y=2.1, label="1", size=7)
p
p + geom_vline(xintercept=2.5, lwd=0.3, lty=2) + geom_vline(xintercept=5.5, lwd=0.3, lty=2) + geom_vline(xintercept=12.5, lwd=0.3, lty=2) +  geom_vline(xintercept=15.5, lwd=0.3, lty=2) + annotate('text', x=26, y = 1.7, label="*", size=7)+ annotate('text', x=27, y = 1.7, label="*", size=7) + annotate('text', x=1.5, y=2.1, label="1", size=4)
p <- ggplot(tmp3, aes(x=locality, y=emg, col=host, fill=host)) + geom_bar(position="stack", stat="identity", alpha=0.4) +theme_minimal()+ scale_colour_manual(values=c('gold2','plum','sienna3'), labels=c("maize", "pearl millet","sorghum"), name="Host") + scale_fill_manual(values=c('gold2','plum','sienna3'), labels=c("maize", "pearl millet","sorghum"), name="Host")+ theme(axis.text.x=element_text(angle=90, vjust=0.4, hjust=1), legend.position="top",panel.grid.major = element_blank(),panel.grid.minor = element_blank()) + ylab("Relative emergence") + xlab("")
p <- p + geom_vline(xintercept=2.5, lwd=0.3, lty=2) + geom_vline(xintercept=5.5, lwd=0.3, lty=2) + geom_vline(xintercept=12.5, lwd=0.3, lty=2) +  geom_vline(xintercept=15.5, lwd=0.3, lty=2) + annotate('text', x=26, y = 1.7, label="*", size=7)+ annotate('text', x=27, y = 1.7, label="*", size=7)
p + geom_vline(xintercept=2.5, lwd=0.3, lty=2) + geom_vline(xintercept=5.5, lwd=0.3, lty=2) + geom_vline(xintercept=12.5, lwd=0.3, lty=2) +  geom_vline(xintercept=15.5, lwd=0.3, lty=2) + annotate('text', x=26, y = 1.7, label="*", size=7)+ annotate('text', x=27, y = 1.7, label="*", size=7) + annotate('text', x=1.5, y=2.1, label="1", size=4)
p + geom_vline(xintercept=2.5, lwd=0.3, lty=2) + geom_vline(xintercept=5.5, lwd=0.3, lty=2) + geom_vline(xintercept=12.5, lwd=0.3, lty=2) +  geom_vline(xintercept=15.5, lwd=0.3, lty=2) + annotate('text', x=26, y = 1.7, label="*", size=7)+ annotate('text', x=27, y = 1.7, label="*", size=7) + annotate('text', x=1.5, y=2.1, label="1", size=6)
p + geom_vline(xintercept=2.5, lwd=0.3, lty=2) + geom_vline(xintercept=5.5, lwd=0.3, lty=2) + geom_vline(xintercept=12.5, lwd=0.3, lty=2) +  geom_vline(xintercept=15.5, lwd=0.3, lty=2) + annotate('text', x=26, y = 1.7, label="*", size=7)+ annotate('text', x=27, y = 1.7, label="*", size=7) + annotate('text', x=1.5, y=2.1, label="1", size=6) + annotate('text', x=4, y=2.1, label="2", size=6)
p + geom_vline(xintercept=2.5, lwd=0.3, lty=2) + geom_vline(xintercept=5.5, lwd=0.3, lty=2) + geom_vline(xintercept=12.5, lwd=0.3, lty=2) +  geom_vline(xintercept=15.5, lwd=0.3, lty=2) + annotate('text', x=26, y = 1.7, label="*", size=7)+ annotate('text', x=27, y = 1.7, label="*", size=7) + annotate('text', x=1.5, y=2.1, label="1", size=6) + annotate('text', x=4, y=2.1, label="2", size=6)++ annotate('text', x=9, y=2.1, label="3", size=6)
p + geom_vline(xintercept=2.5, lwd=0.3, lty=2) + geom_vline(xintercept=5.5, lwd=0.3, lty=2) + geom_vline(xintercept=12.5, lwd=0.3, lty=2) +  geom_vline(xintercept=15.5, lwd=0.3, lty=2) + annotate('text', x=26, y = 1.7, label="*", size=7)+ annotate('text', x=27, y = 1.7, label="*", size=7) + annotate('text', x=1.5, y=2.1, label="1", size=6) + annotate('text', x=4, y=2.1, label="2", size=6)+ annotate('text', x=9, y=2.1, label="3", size=6)
p + geom_vline(xintercept=2.5, lwd=0.3, lty=2) + geom_vline(xintercept=5.5, lwd=0.3, lty=2) + geom_vline(xintercept=12.5, lwd=0.3, lty=2) +  geom_vline(xintercept=15.5, lwd=0.3, lty=2) + annotate('text', x=26, y = 1.7, label="*", size=7)+ annotate('text', x=27, y = 1.7, label="*", size=7) + annotate('text', x=1.5, y=2.1, label="1", size=6) + annotate('text', x=4, y=2.1, label="2", size=6)+ annotate('text', x=9, y=2.1, label="3", size=6)+ annotate('text', x=11, y=2.1, label="4", size=6)
p + geom_vline(xintercept=2.5, lwd=0.3, lty=2) + geom_vline(xintercept=5.5, lwd=0.3, lty=2) + geom_vline(xintercept=12.5, lwd=0.3, lty=2) +  geom_vline(xintercept=15.5, lwd=0.3, lty=2) + annotate('text', x=26, y = 1.7, label="*", size=7)+ annotate('text', x=27, y = 1.7, label="*", size=7) + annotate('text', x=1.5, y=2.1, label="1", size=6) + annotate('text', x=4, y=2.1, label="2", size=6)+ annotate('text', x=9, y=2.1, label="3", size=6)+ annotate('text', x=14, y=2.1, label="4", size=6)
p + geom_vline(xintercept=2.5, lwd=0.3, lty=2) + geom_vline(xintercept=5.5, lwd=0.3, lty=2) + geom_vline(xintercept=12.5, lwd=0.3, lty=2) +  geom_vline(xintercept=15.5, lwd=0.3, lty=2) + annotate('text', x=26, y = 1.7, label="*", size=7)+ annotate('text', x=27, y = 1.7, label="*", size=7) + annotate('text', x=1.5, y=2.1, label="1", size=6) + annotate('text', x=4, y=2.1, label="2", size=6)+ annotate('text', x=9, y=2.1, label="3", size=6)+ annotate('text', x=20, y=2.1, label="5", size=6)
p + geom_vline(xintercept=2.5, lwd=0.3, lty=2) + geom_vline(xintercept=5.5, lwd=0.3, lty=2) + geom_vline(xintercept=12.5, lwd=0.3, lty=2) +  geom_vline(xintercept=15.5, lwd=0.3, lty=2) + annotate('text', x=26, y = 1.7, label="*", size=7)+ annotate('text', x=27, y = 1.7, label="*", size=7) + annotate('text', x=1.5, y=2.1, label="1", size=6) + annotate('text', x=4, y=2.1, label="2", size=6)+ annotate('text', x=9, y=2.1, label="3", size=6)+ annotate('text', x=20, y=2.1, label="5", size=6)+ annotate('text', x=14, y=2.1, label="4", size=6)
p <- p + geom_vline(xintercept=2.5, lwd=0.3, lty=2) + geom_vline(xintercept=5.5, lwd=0.3, lty=2) + geom_vline(xintercept=12.5, lwd=0.3, lty=2) +  geom_vline(xintercept=15.5, lwd=0.3, lty=2) + annotate('text', x=26, y = 1.7, label="*", size=7)+ annotate('text', x=27, y = 1.7, label="*", size=7) + annotate('text', x=1.5, y=2.1, label="1", size=6) + annotate('text', x=4, y=2.1, label="2", size=6)+ annotate('text', x=9, y=2.1, label="3", size=6)+ annotate('text', x=20, y=2.1, label="5", size=6)+ annotate('text', x=14, y=2.1, label="4", size=6)
host.df <- as.data.frame(as.data.frame(tmp) %>% pivot_wider(id_cols=c(locality,host), names_from= host,values_from=emg))
host.df <- subset(host.df, maize!="NA")
row.names(host.df) <- host.df$locality
dd <- as.dist(1-cor(t(host.df[,2:4])))
hc <- hclust(dd, method="complete")
q <- ggdendrogram(hc) + geom_hline(yintercept=0.5, lty=2) + ylim(c(0,2.2))
pdf(file="SpecializationFig.pdf", height=3, width=6.8)
plot_grid(p,q, labels=c('A','B'))
dev.off()
dev.off()
library(raster)
library(maptools)
data(wrld_simpl)
library(raster)
library(dplyr)
library(rgdal)
library(dismo)
library(viridis)
library(ggplot2)
library(tidyr)
library(lme4)
library(rgeos)
library(cowplot)
enm <- raster('/Users/emilywork/Downloads/all.CLY250.tif')
enm <- aggregate(enm, fact=10)
enm.s <- raster('/Users/emilywork/Downloads/sorg.CLY250.tif')
enm.s <- aggregate(enm.s, fact=10)
enm.z <- raster('/Users/emilywork/Downloads/maiz.CLY250.tif')
enm.z <- aggregate(enm.z, fact=10)
enm.m <- raster('/Users/emilywork/Downloads/mill.CLY250.tif')
enm.m <- aggregate(enm.m, fact=10)
?geom_smooth
?stats::loess
library(ggdendro)
library(dplyr)
library(ggplot2)
library(tidyr)
library(cowplot)
?plot_grid
library(ggdendro)
library(dplyr)
library(ggplot2)
library(tidyr)
library(cowplot)
setwd('/Users/emilywork/Documents/GitHub/StrigaMacroecologyMS')
################  load gps points for experimental studies
meta <- read.csv('SI.dat.1.30.20.csv')
meta <- subset(meta, emergence != "NA") # 27 localities
############## fig for relative emergence.
tmp <- meta %>% select(locality, emergence, host) %>% group_by(locality, host) %>% summarize(emg = mean(emergence))
tmp2 <- tmp %>% group_by(locality) %>% summarize(total=sum(emg))
tmp3 <- inner_join(tmp, tmp2)
p <- ggplot(tmp3, aes(x=locality, y=emg, col=host, fill=host)) + geom_bar(position="stack", stat="identity", alpha=0.4) +theme_minimal()+ scale_colour_manual(values=c('gold2','plum','sienna3'), labels=c("maize", "pearl millet","sorghum"), name="Host") + scale_fill_manual(values=c('gold2','plum','sienna3'), labels=c("maize", "pearl millet","sorghum"), name="Host")+ theme(axis.text.x=element_text(angle=90, vjust=0.4, hjust=1), legend.position="top",panel.grid.major = element_blank(),panel.grid.minor = element_blank()) + ylab("Relative emergence") + xlab("")
p <- p + geom_vline(xintercept=2.5, lwd=0.3, lty=2) + geom_vline(xintercept=5.5, lwd=0.3, lty=2) + geom_vline(xintercept=12.5, lwd=0.3, lty=2) +  geom_vline(xintercept=15.5, lwd=0.3, lty=2) + annotate('text', x=26, y = 1.7, label="*", size=7)+ annotate('text', x=27, y = 1.7, label="*", size=7) + annotate('text', x=1.5, y=2.1, label="1", size=6) + annotate('text', x=4, y=2.1, label="2", size=6)+ annotate('text', x=9, y=2.1, label="3", size=6)+ annotate('text', x=20, y=2.1, label="5", size=6)+ annotate('text', x=14, y=2.1, label="4", size=6)
host.df <- as.data.frame(as.data.frame(tmp) %>% pivot_wider(id_cols=c(locality,host), names_from= host,values_from=emg))
host.df <- subset(host.df, maize!="NA")
row.names(host.df) <- host.df$locality
dd <- as.dist(1-cor(t(host.df[,2:4])))
hc <- hclust(dd, method="complete")
q <- ggdendrogram(hc) + geom_hline(yintercept=0.5, lty=2) + ylim(c(0,2.2))
plot_grid(p,q, labels=c('A','B'), align = "v")
?plot_grid
plot_grid(p,q, labels=c('A','B'), nrow = 2)
tmp <- meta %>% select(locality, emergence, host) %>% group_by(locality, host) %>% summarize(emg = mean(emergence))
tmp2 <- tmp %>% group_by(locality) %>% summarize(total=sum(emg))
tmp3 <- inner_join(tmp, tmp2)
tmp3$locality <- factor(tmp3$locality, levels = c("Bambey", "Maradi", "Mintimbougou","FarakoBa","SinthionMaleme","Samaru","AbuNaama","Kamboinse","Kobo","Yendi","Tamale","WadMedani","Galadima","Bakura","Damaturu","Jibiya","Andre","Kankia","Bida","Gombe","Gumi","Busia","Gwoza","Mokwa","Ngezima","Kazgail","Obeid"))
p <- ggplot(tmp3, aes(x=locality, y=emg, col=host, fill=host)) + geom_bar(position="stack", stat="identity", alpha=0.4) +theme_minimal()+ scale_colour_manual(values=c('gold2','plum','sienna3'), labels=c("maize", "pearl millet","sorghum"), name="Host") + scale_fill_manual(values=c('gold2','plum','sienna3'), labels=c("maize", "pearl millet","sorghum"), name="Host")+ theme(axis.text.x=element_text(angle=90, vjust=0.4, hjust=1), legend.position="top",panel.grid.major = element_blank(),panel.grid.minor = element_blank()) + ylab("Relative emergence") + xlab("")
p
p <- p + geom_vline(xintercept=2.5, lwd=0.3, lty=2) + geom_vline(xintercept=5.5, lwd=0.3, lty=2) + geom_vline(xintercept=12.5, lwd=0.3, lty=2) +  geom_vline(xintercept=15.5, lwd=0.3, lty=2) + annotate('text', x=26, y = 1.7, label="*", size=7)+ annotate('text', x=27, y = 1.7, label="*", size=7) + annotate('text', x=1.5, y=2.1, label="1", size=6) + annotate('text', x=4, y=2.1, label="2", size=6)+ annotate('text', x=9, y=2.1, label="3", size=6)+ annotate('text', x=20, y=2.1, label="5", size=6)+ annotate('text', x=14, y=2.1, label="4", size=6)
p
?ggdendrogram
q <- ggdendrogram(hc) + geom_hline(yintercept=0.5, lty=2) + ylim(c(0,2.2), leaf_labels=F)
q
q <- ggdendrogram(hc) + geom_hline(yintercept=0.5, lty=2) + ylim(c(0,2.2))+ leaf_labels=F)
?ggdendrogram
q <- ggdendrogram(hc,  leaf_labels=F) + geom_hline(yintercept=0.5, lty=2) + ylim(c(0,2.2)))
q <- ggdendrogram(hc,  leaf_labels=F) + geom_hline(yintercept=0.5, lty=2) + ylim(c(0,2.2))
q
q <- ggdendrogram(hc,  leaf_labels=FALSE) + geom_hline(yintercept=0.5, lty=2) + ylim(c(0,2.2))
q <- ggdendrogram(hc,  leaf_labels=FALSE)
q
?ggdendrogram
q <- ggdendrogram(hc,  leaf_labels=F)
q
ggdendrogram(hc,  leaf_labels=F)
ggdendrogram(hc,  leaf_labels=F)
ggdendrogram(hc,  labels=F)
q <- ggdendrogram(hc,  labels=FALSE) + geom_hline(yintercept=0.5, lty=2) + ylim(c(0,2.2))
q
plot_grid(q, p,labels=c('A','B'), align = "v")
plot_grid(q, p,labels=c('A','B'), nrow = 2)
p <- ggplot(tmp3, aes(x=locality, y=emg, col=host, fill=host)) + geom_bar(position="stack", stat="identity", alpha=0.4) +theme_minimal()+ scale_colour_manual(values=c('gold2','plum','sienna3'), labels=c("maize", "pearl millet","sorghum"), name="Host") + scale_fill_manual(values=c('gold2','plum','sienna3'), labels=c("maize", "pearl millet","sorghum"), name="Host")+ theme(axis.text.x=element_text(angle=90, vjust=0.4, hjust=1), legend.position="bottom",panel.grid.major = element_blank(),panel.grid.minor = element_blank()) + ylab("Relative emergence") + xlab("")
p <- p + geom_vline(xintercept=2.5, lwd=0.3, lty=2) + geom_vline(xintercept=5.5, lwd=0.3, lty=2) + geom_vline(xintercept=12.5, lwd=0.3, lty=2) +  geom_vline(xintercept=15.5, lwd=0.3, lty=2) + annotate('text', x=26, y = 1.7, label="*", size=7)+ annotate('text', x=27, y = 1.7, label="*", size=7) + annotate('text', x=1.5, y=2.1, label="1", size=6) + annotate('text', x=4, y=2.1, label="2", size=6)+ annotate('text', x=9, y=2.1, label="3", size=6)+ annotate('text', x=20, y=2.1, label="5", size=6)+ annotate('text', x=14, y=2.1, label="4", size=6)
plot_grid(q, p,labels=c('A','B'), nrow = 2)
q <- ggdendrogram(hc,  leaf_labels=F) + geom_hline(yintercept=0.5, lty=2)
plot_grid(q, p,labels=c('A','B'), nrow = 2)
q <- ggdendrogram(hc,  leaf_labels=F) + geom_hline(yintercept=0.5, lty=2) + ylim(c(0,2.2))
plot_grid(q, p,labels=c('A','B'), nrow = 2)
q <- ggdendrogram(hc,  labels=F) + geom_hline(yintercept=0.5, lty=2) + ylim(c(0,2.2))
plot_grid(q, p,labels=c('A','B'), nrow = 2)
plot_grid(q, p,labels=c('A','B'), nrow = 2)
?ggdendrogram
q <- ggdendrogram(hc,  labels=F) + geom_hline(yintercept=0.5, lty=2) + ylim(c(0,2.2)) + theme_dendro()
q
plot_grid(q, p,labels=c('A','B'), nrow = 2)
q <- ggdendrogram(hc,  labels=F) + geom_hline(yintercept=0.5, lty=2) + ylim(c(0,2.2)) + xlim(c(0,27))
plot_grid(q, p,labels=c('A','B'), nrow = 2)
q <- ggdendrogram(hc,  labels=F) + geom_hline(yintercept=0.5, lty=2) + ylim(c(0,2.2)) + xlim(c(0,27)) + theme_dendro()
plot_grid(q, p,labels=c('A','B'), nrow = 2)
q <- ggdendrogram(hc,  labels=F) + geom_hline(yintercept=0.5, lty=2) + ylim(c(0,2.2)) + xlim(c(-1,27)) + theme_dendro()
plot_grid(q, p,labels=c('A','B'), nrow = 2)
q <- ggdendrogram(hc,  labels=F) + geom_hline(yintercept=0.5, lty=2) + ylim(c(0,2.2)) + xlim(c(1,27)) + theme_dendro()
plot_grid(q, p,labels=c('A','B'), nrow = 2)
q <- ggdendrogram(hc,  labels=F) + geom_hline(yintercept=0.5, lty=2) + ylim(c(0,2.2)) + xlim(c(0.5,27)) + theme_dendro()
plot_grid(q, p,labels=c('A','B'), nrow = 2)
q <- ggdendrogram(hc,  labels=F) + geom_hline(yintercept=0.5, lty=2) + ylim(c(0,2.2)) + xlim(c(0.5,27))
plot_grid(q, p,labels=c('A','B'), nrow = 2)
pdf(file="SpecializationFig.pdf", height=3.23, width=3.23)
dev.off()
pdf(file="SpecializationFigv2.pdf", height=3.23, width=6)
plot_grid(q, p,labels=c('A','B'), nrow = 2)
dev.off()
dev.off()
pdf(file="SpecializationFigv2.pdf", height=3.23, width=6)
plot_grid(q, p,labels=c('A','B'), nrow = 2)
dev.off()
pdf(file="SpecializationFigv2.pdf", width=3.23, height=6)
plot_grid(q, p,labels=c('A','B'), nrow = 2)
dev.off()
?plot_grid
plot_grid(q, p,labels=c('A','B'), nrow = 2, rel_heights = c(2,1))
plot_grid(q, p,labels=c('A','B'), nrow = 2, rel_heights = c(1,2))
pdf(file="SpecializationFigv2.pdf", width=3.23, height=6)
plot_grid(q, p,labels=c('A','B'), nrow = 2, rel_heights = c(1,2))
dev.off()
?ggdendrogram
?hclust
?dist
## with bootstrapping
install.packages('shipunov')
## with bootstrapping
library(shipunov)
citation(shipunov)
citation('shipunov')
head(host.df)
## with bootstrapping
install.packages('pvclust')
## with bootstrapping
library(pvclust)
head(host.df)
t(host.df)
dd
?pvclust
fit <- pvclust(t(host.df), method.hclust="complete",
method.dist="correlation")
t(host.df)
host.df <- as.data.frame(as.data.frame(tmp) %>% pivot_wider(id_cols=c(locality,host), names_from= host,values_from=emg))
host.df <- subset(host.df, maize!="NA")
t(host.df)
row.names(host.df) <- host.df$locality
t(host.df)
host.df
host.df[,1:3]
host.df[,2:4]
t(host.df[,2:4])
fit <- pvclust(t(host.df[,2:4]), method.hclust="complete",method.dist="correlation")
host.df2 <- t(host.df[,2:4])
fit <- pvclust(host.df2), method.hclust="complete",method.dist="correlation")
fit <- pvclust(host.df2, method.hclust="complete",method.dist="correlation")
as.matrix(host.df2)
fit <- pvclust(as.matrix(host.df2), method.hclust="complete",method.dist="correlation")
host.df2 <- t(host.df[,2:4])
host.df2
fit <- pvclust(as.matrix(host.df), method.hclust="complete",method.dist="correlation")
host.df
host.df2
class(host.df2)
host.df2[1,1]
fit <- pvclust(host.df2, method.hclust="complete",method.dist="correlation")
fit <- pvclust(t(host.df2), method.hclust="complete",method.dist="correlation")
fit
plot(fit)
fit <- pvclust(t(t(host.df2)), method.hclust="complete",method.dist="correlation")
?pvclust
host.df2
fit <- pvclust(t(t(host.df2)), method.hclust="complete",method.dist="correlation", use.cor="complete.obs")
fit <- pvclust(host.df2, method.hclust="complete",method.dist="correlation", use.cor="complete.obs")
fit <- pvclust(host.df2, method.hclust="complete")
fit <- pvclust(t(t(host.df2)), method.hclust="complete",method.dist="correlation", use.cor="complete.obs")
library(fpc)
install.packages('fbc')
fit <- pvclust(t(host.df2), method.hclust="complete",method.dist="correlation")
fit <- pvclust((host.df2), method.hclust="complete",method.dist="correlation")
?pvclust
fit <- pvclust((host.df2), method.hclust="complete",method.dist="correlation", r=1)
fit <- pvclust((host.df2), method.hclust="complete",method.dist="correlation", r=0.1)
fit <- pvclust((host.df2), method.hclust="complete",method.dist="correlation", r=0.5)
fit <- pvclust((host.df2), method.hclust="complete",method.dist="correlation", r=seq(0.7,1.4,by=.1))
fit <- pvclust((host.df2), method.hclust="complete",method.dist="correlation", r=seq(0.7,1.3,by=.1))
fit <- pvclust((host.df2), method.hclust="complete",method.dist="correlation", r=seq(0.7,0.9,by=.1))
fit <- pvclust((host.df2), method.hclust="complete",method.dist="correlation", r=seq(0.7,1.5,by=.1))
fit <- pvclust((host.df2), method.hclust="complete",method.dist="correlation", r=seq(0.7,2,by=.1))
fit
plot(fit)
fit <- pvclust((host.df2), method.hclust="complete",method.dist="correlation", r=seq(0.7,1.4,by=.1))
fit
fit2 <- pvclust((host.df2), method.hclust="complete",method.dist="correlation")
fit2 <- pvclust((host.df2), method.hclust="complete",method.dist="correlation", r=seq(0.7,1.4,by=.1)))
fit2 <- pvclust((host.df2), method.hclust="complete",method.dist="correlation", r=seq(0.7,1.4,by=.1))
plot(fit2)
fit2 <- pvclust((host.df2), method.hclust="complete",method.dist="correlation", r=seq(0.7,2,by=.1))
plot(fit2)
?pvclust
plot(fit2)
?pvrect
pvrect(fit2)
?pvrect
pvrect(fit2, pv="bp")
plot(fit2)
pvrect(fit2, pv="bp")
fit2 <- pvclust((host.df2), method.hclust="complete",method.dist="correlation", r=seq(0.7,1.4,by=.1))
plot(fit2)
pvrect(fit2, pv="bp")
library(raster)
library(maptools)
data(wrld_simpl)
library(raster)
library(dplyr)
library(rgdal)
library(dismo)
library(maps)
data(worldMapEnv)
library(viridis)
library(ggplot2)
library(tidyr)
library(lme4)
library(pals)
library(rgeos)
################ downsample enm layer resolution to match earthstat
enm <- raster('/Users/emilywork/Downloads/all.CLY250.tif')
enm <- aggregate(enm, fact=10)
sorg.yld <- raster('/Users/emilywork/Desktop/StrigaMacroecology/EarthStat/sorghum_HarvAreaYield_Geotiff/sorghum_YieldPerHectare.tif')
sorg.yld <- crop(sorg.yld, enm)
mill.yld <- raster('/Users/emilywork/Desktop/StrigaMacroecology/EarthStat/millet_HarvAreaYield_Geotiff/millet_YieldPerHectare.tif')
mill.yld <- crop(mill.yld, enm)
maiz.yld <- raster('/Users/emilywork/Desktop/StrigaMacroecology/EarthStat/maize_HarvAreaYield_Geotiff/maize_YieldPerHectare.tif')
maiz.yld <- crop(maiz.yld, enm)
all.yld <- maiz.yld + mill.yld + sorg.yld
tmp <- meta %>% select(locality, emergence, host) %>% group_by(locality, host) %>% summarize(emg = mean(emergence), sd = sd(emergence), n=length(emergence))
tmp2 <- tmp %>% group_by(locality) %>% summarize(total=sum(emg))
tmp3 <- inner_join(tmp, tmp2)
tmp <- meta %>% group_by(locality,host) %>% summarize(Emg = mean(emergence), lat = mean(lat), lon=mean(lon))
tmp$productivity <- raster::extract(all.yld, cbind.data.frame(tmp$lon, tmp$lat))
tmp.wide <- as.data.frame(tmp %>% pivot_wider(names_from=host, values_from=Emg))
tmp.wide$spec <- NULL
for (i in 1:nrow(tmp.wide)){
highest <- max(tmp.wide[i,5:7])
sec_highest <- sort(tmp.wide[i,5:7],partial=2)[2]
min_val <- min(tmp.wide[i,5:7])
tmp.wide$pdi[i] <- ((highest - sec_highest) + (highest - min_val))/2
}
tmp.wide$pdi <- as.numeric(tmp.wide$pdi)
tmp.wide <- na.omit(tmp.wide)
ggplot(tmp.wide, aes(x=productivity, y=pdi)) + geom_point(size=2, alpha=0.5) + ylab("Difference in relative emergence \non two best hosts") + xlab("Total yield per hectare") + geom_smooth(method ="lm")
summary(lm(pdi ~ productivity, data=tmp.wide))
ggplot(tmp3, aes(x=reorder(locality,-total), y=emg, col=host, fill=host)) + geom_bar(position="stack", stat="identity", alpha=0.4) +theme_minimal()+ scale_colour_manual(values=c('gold2','plum','sienna3')) + scale_fill_manual(values=c('gold2','plum','sienna3'))+ theme(axis.text.x=element_text(angle=90, vjust=0.2, hjust=1)) + ylab("Relative emergence") + xlab("Locality") + geom_errorbar()
############## fig for relative emergence.
tmp <- meta %>% select(locality, emergence, host) %>% group_by(locality, host) %>% summarize(emg = mean(emergence), sd = sd(emergence), n=length(emergence))
tmp2 <- tmp %>% group_by(locality) %>% summarize(total=sum(emg))
### habitat suitability at location of all S. hermonthica occurrences
# occurrences for subset on different hosts
shgeo <- read.csv('/Users/emilywork/Downloads/pnas.1908707117.sd03.csv', header=T)
coordinates(shgeo) <- ~lon+lat
sh.s <- subset(shgeo, sorghum==1)
sh.z <- subset(shgeo, maize==1)
sh.m <- subset(shgeo, millet==1)
r <- enm
res(r) <- 0.01 #0.1 degree ~ 11 km
r <- extend(r, extent(r)+1)
acsel.s <- gridSample(sh.s, r, n=1)
acsel.z <- gridSample(sh.z, r, n=1)
acsel.m <- gridSample(sh.m, r, n=1)
hs <- raster::extract(enm.s, acsel.s)
enm.s <- raster('/Users/emilywork/Downloads/sorg.CLY250.tif')
enm.s <- aggregate(enm.s, fact=10)
enm.z <- raster('/Users/emilywork/Downloads/maiz.CLY250.tif')
enm.z <- aggregate(enm.z, fact=10)
enm.m <- raster('/Users/emilywork/Downloads/mill.CLY250.tif')
enm.m <- aggregate(enm.m, fact=10)
acsel.s <- gridSample(sh.s, r, n=1)
acsel.z <- gridSample(sh.z, r, n=1)
acsel.m <- gridSample(sh.m, r, n=1)
hs <- raster::extract(enm.s, acsel.s)
acsel.s <- as.data.frame(acsel.s)
acsel.s$host <- "sorghum"
acsel.s$hs <- hs
hs <- raster::extract(enm.z, acsel.z)
acsel.z <- as.data.frame(acsel.z)
acsel.z$host <- "maize"
acsel.z$hs <- hs
hs <- raster::extract(enm.m, acsel.m)
acsel.m <- as.data.frame(acsel.m)
acsel.m$host <- "millet"
acsel.m$hs <- hs
acsel <- rbind.data.frame(acsel.s, acsel.z, acsel.m)
acsel$prod <- raster::extract(all.yld, cbind(acsel$lon,acsel$lat))
q <- ggplot(acsel, aes(x=prod, y=hs, fill=host, col=host)) + geom_point(alpha=0.5, pch=21, size=0.75) + ylab("Parasite HS") + xlab("Productivity") + geom_smooth(se=T, lwd=1, alpha=0.5, level=0.9)+theme_minimal()+theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(), legend.position = "none") + xlim(c(0,4.75)) + scale_fill_manual(values=c('gold2','plum','sienna3'), name="Host")+ scale_color_manual(values=c('gold3','plum','sienna3'), name="Host")
q
q <- ggplot(acsel, aes(y=prod, x=hs, fill=host, col=host)) + geom_point(alpha=0.5, pch=21, size=0.75) + ylab("Parasite HS") + xlab("Productivity") + geom_smooth(se=T, lwd=1, alpha=0.5, level=0.9)+theme_minimal()+theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(), legend.position = "none") + xlim(c(0,4.75)) + scale_fill_manual(values=c('gold2','plum','sienna3'), name="Host")+ scale_color_manual(values=c('gold3','plum','sienna3'), name="Host")
q
ggplot(acsel, aes(y=prod, x=hs, fill=host, col=host)) + geom_point(alpha=0.5, pch=21, size=0.75) + xlab("Parasite HS") + ylab("Productivity") + geom_smooth(se=T, lwd=1, alpha=0.5, level=0.9)+theme_minimal()+theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(), legend.position = "none") + scale_fill_manual(values=c('gold2','plum','sienna3'), name="Host")+ scale_color_manual(values=c('gold3','plum','sienna3'), name="Host")
ggplot(acsel, aes(y=prod, x=hs, fill=host, col=host)) + geom_point(alpha=0.5, pch=21, size=0.75) + xlab("Parasite HS") + ylab("Productivity") + geom_smooth(se=T, lwd=1, alpha=0.5, level=0.9)+theme_minimal()+theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(), legend.position = "none") + scale_fill_manual(values=c('gold2','plum','sienna3'), name="Host")+ scale_color_manual(values=c('gold3','plum','sienna3'), name="Host") + ylim(c(0,6))
ggplot(acsel, aes(y=prod, x=hs, fill=host, col=host)) + geom_point(alpha=0.5, pch=21, size=0.75) + xlab("Parasite HS") + ylab("Productivity") + geom_smooth(se=T, lwd=1, alpha=0.5, level=0.9)+theme_minimal()+theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(), legend.position = "none") + scale_fill_manual(values=c('gold2','plum','sienna3'), name="Host")+ scale_color_manual(values=c('gold3','plum','sienna3'), name="Host") + ylim(c(0,5))
q <- ggplot(acsel, aes(y=prod, x=hs, fill=host, col=host)) + geom_point(alpha=0.5, pch=21, size=0.75) + xlab("Parasite HS") + xlab("Combined Productivity") + geom_smooth(se=T, lwd=1, alpha=0.5, level=0.9)+theme_minimal()+theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(), legend.position = "none") + scale_fill_manual(values=c('gold2','plum','sienna3'), name="Host")+ scale_color_manual(values=c('gold3','plum','sienna3'), name="Host")
q
q <- ggplot(acsel, aes(y=prod, x=hs, fill=host, col=host)) + geom_point(alpha=0.5, pch=21, size=0.75) + xlab("Parasite HS") + xlab("Combined Productivity") + geom_smooth(se=T, lwd=1, alpha=0.5, level=0.9)+theme_minimal()+theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(), legend.position = "none") + scale_fill_manual(values=c('gold2','plum','sienna3'), name="Host")+ scale_color_manual(values=c('gold3','plum','sienna3'), name="Host") + ylim(c(0,5))
q
q <- ggplot(acsel, aes(y=prod, x=hs, fill=host, col=host)) + geom_point(alpha=0.5, pch=21, size=0.75) + xlab("Parasite HS") + ylab("Combined Productivity") + geom_smooth(se=T, lwd=1, alpha=0.5, level=0.9)+theme_minimal()+theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(), legend.position = "none") + scale_fill_manual(values=c('gold2','plum','sienna3'), name="Host")+ scale_color_manual(values=c('gold3','plum','sienna3'), name="Host") + ylim(c(0,5))
q
head(acsel)
ggplot(acsel, aes(x=prod, group=host, fill=host)) + geom_hist()
ggplot(acsel, aes(x=prod, group=host, fill=host)) + geom_density()
ggplot(acsel, aes(x=prod, group=host, fill=host)) + geom_density(alpha=0.5)
st.yld <- stdev(maiz.yld, mill.yld, sorg.yld)
st.yld <- calc(stack(maiz.yld, mill.yld, sorg.yld),sd)
acsel$prod <- raster::extract(st.yld, cbind(acsel$lon,acsel$lat))
q <- ggplot(acsel, aes(y=prod, x=hs, fill=host, col=host)) + geom_point(alpha=0.5, pch=21, size=0.75) + xlab("Parasite HS") + ylab("Combined Productivity") + geom_smooth(se=T, lwd=1, alpha=0.5, level=0.9)+theme_minimal()+theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(), legend.position = "none") + scale_fill_manual(values=c('gold2','plum','sienna3'), name="Host")+ scale_color_manual(values=c('gold3','plum','sienna3'), name="Host") + ylim(c(0,5))
q
q <- ggplot(acsel, aes(x=prod, y=hs, fill=host, col=host)) + geom_point(alpha=0.5, pch=21, size=0.75) + xlab("Parasite HS") + ylab("Combined Productivity") + geom_smooth(se=T, lwd=1, alpha=0.5, level=0.9)+theme_minimal()+theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(), legend.position = "none") + scale_fill_manual(values=c('gold2','plum','sienna3'), name="Host")+ scale_color_manual(values=c('gold3','plum','sienna3'), name="Host") + ylim(c(0,5))
q <- ggplot(acsel, aes(x=prod, y=hs, fill=host, col=host)) + geom_point(alpha=0.5, pch=21, size=0.75) + xlab("Parasite HS") + ylab("Combined Productivity") + geom_smooth(se=T, lwd=1, alpha=0.5, level=0.9)+theme_minimal()+theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(), legend.position = "none") + scale_fill_manual(values=c('gold2','plum','sienna3'), name="Host")+ scale_color_manual(values=c('gold3','plum','sienna3'), name="Host")
q
q <- ggplot(acsel, aes(y=prod, x=hs, fill=host, col=host)) + geom_point(alpha=0.5, pch=21, size=0.75) + xlab("Parasite HS") + ylab("Combined Productivity") + geom_smooth(se=T, lwd=1, alpha=0.5, level=0.9)+theme_minimal()+theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(), legend.position = "none") + scale_fill_manual(values=c('gold2','plum','sienna3'), name="Host")+ scale_color_manual(values=c('gold3','plum','sienna3'), name="Host")
q
q <- ggplot(acsel, aes(y=prod, x=hs, fill=host, col=host)) + geom_point(alpha=0.5, pch=21, size=0.75) + xlab("Parasite HS") + ylab("Combined Productivity") + geom_smooth(se=T, lwd=1, alpha=0.5, level=0.9)+theme_minimal()+theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(), legend.position = "none") + scale_fill_manual(values=c('gold2','plum','sienna3'), name="Host")+ scale_color_manual(values=c('gold3','plum','sienna3'), name="Host")+ylim(c(0,2))
q
q <- ggplot(acsel, aes(y=prod, x=hs, fill=host, col=host)) + geom_point(alpha=0.5, pch=21, size=0.75) + xlab("Parasite HS") + ylab("Combined Productivity") + geom_smooth(se=T, lwd=1, alpha=0.5, level=0.9)+theme_minimal()+theme(panel.grid.major = element_blank(),panel.grid.minor = element_blank(), legend.position = "none") + scale_fill_manual(values=c('gold2','plum','sienna3'), name="Host")+ scale_color_manual(values=c('gold3','plum','sienna3'), name="Host")+ylim(c(0,1))
q
library(enmtools)
library(ENMtools)
install.packages('ENMtools')
install.packages('ENMTools')
library(ENMTools)
?nicheOverlap
?env.overlap
fit2 <- pvclust((host.df2), method.hclust="complete",method.dist="correlation", r=seq(0.7,1.4,by=.1))
plot(fit2)
fit2 <- pvclust((host.df2), method.hclust="complete",method.dist="correlation", r=seq(0.7,2,by=.1))
plot(fit2)
?pvclust
fit2 <- pvclust((host.df2), method.hclust="complete",method.dist="abscor", r=seq(0.7,2,by=.1))
?pvclust
fit2
fit2 <- pvclust((host.df2), method.hclust="complete",method.dist="abscor", r=seq(0.7,2.5,by=.1))
plot(fit2)
fit2 <- pvclust((host.df2), method.hclust="complete",method.dist="abscor", r=2
)
plot(fit2)
plot(fit2)
fit2 <- pvclust((host.df2), method.hclust="complete",method.dist="correlation", r=1)
plot(fit2)
citation()
library(raster)
library(viridis)
library(maps)
all <- raster('/Users/ebellis/Desktop/Projects/StigaxSorghum/MacroecologyMS/Fig1/all.CLY250.tif')
all <- raster('~/Downloads/all.CLY250.tif')
#map(database="world", xlim=c(-20,60),ylim=c(-40,45))
plot(mill, col=viridis(n=100), legend=F, xaxt='n', yaxt='n')
#map(database="world", xlim=c(-20,60),ylim=c(-40,45))
plot(all, col=viridis(n=100), legend=F, xaxt='n', yaxt='n')
#map(database="world", xlim=c(-20,60),ylim=c(-40,45))
plot(all, col=viridis(n=100), legend=T, xaxt='n', yaxt='n')
